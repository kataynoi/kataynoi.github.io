---
layout: post
title: การนำเข้ารายงานใหม่ 
---

#### การนำเข้ารายงาน
---
รายงานในโปรแกรม Hosxp_pcu นั้นจะมีรายงานตั้งต้นมาให้ส่วนหนึ่ง และ Admin สามารถเขียนรายงานขึ้นมาเองได้ และสามารถนำรายงานที่เขียนแจกจ่ายรายงานที่เขียนไปให้ผู้
อื่นใช้งานได้ด้วยโดยการนำเข้ารายงาน 
> วิธีการเข้าดูรายงานในโปรแกรม Hosxp_pcu ดังรูป
 
![Report Central](/img/setting/report.png)

> เมื่อเข้าสู่ `Report Central` แล้วจะเห็นรายงานแบ่งออกเป็นหมวดหมู่ ในแต่ละหมวดก็จะมีหลายๆรายงาน ซึ่งรายงานเหล่านี้เราสามารถนำเข้ามาเพิ่มได้ ทั้งแบบ
รวมกันเป็น  `Report Template` คือเอารายงานมาทั้งหมด หรือจะนำเข้ามาบางรายงานก็ได้

![Report Central](/img/setting/report_central.png)


#### ตารางที่เกี่ยวข้องกับรายงานในโปรแกรม Hosxp_pcu 
--- 
> โดยตารางหลักที่จัดเก็บรายงานทั้งหมดไว้คือ `reporttemplate` โดยเราสามารถเข้าไปดูรายงานได้โดยการเข้าไปที่ [SqlQuery]({% link _posts/2016-11-02-Sql_query_hosxp.md %})  แล้วพิมพ์ `reporttemplate` แล้วสั่ง `Run`
จะพบข้อมูลของตารางรายงานที่เรามี

![Report Central](/img/setting/reporttemplate.png)

#### นำเข้ารายงานใหม่ทั้งหมด
---
การนำเข้ารายงานใหม่ทั้งหมดสามารถทำได้โดยการลบรายงานเก่าออกทั้งหมดก่อน แล้วจึงนำเข้าใหม่ ทั้งหมดครับ หรือจะนำเข้าทับไปเลยก็ได้โดยรายงานเดิมที่มีอยู่จะไม่หายไป 
และรายงานใหม่จะเพิ่มเข้ามา ที่จริงผมว่า ลบออกดีกว่าเนาะ เพราะว่า เด๊่ยวรายงานจะมากไปแล้วหาใช้ไม่เจอครับ 

> วิธีลบรายงานทั้งหมดก่อนนำเข้าใหม่ ให้เราเข้าไปที่ [SqlQuery]({% link _posts/2016-11-02-Sql_query_hosxp.md %}) แล้ว พิมพ์ `reporttemplate` แล้วสั่ง `Run` เสร็จแล้วเราเปลี่ยน คำสั่ง
จาก `select * from reporttemplate` ไปเป็น `delete from reporttemplate`  แล้ว สั่ง `Exce` เพื่อลบรายงานเดิมออก **อย่าลยผิดตามรางนะครับเด๊่ยวได้เรื่องอื่นแทน**

![Delete All report](/img/setting/del_report.png)

> 1. หลังจากนนั้น ให้เรา พิมพ์ `reporttemplate` ในช่อง Open table อีกครั้งแล้วสั่ง `Run` จะพบรายงานที่ว่างเปล่า 
> 2. แล้วให้เลือกที่ `Open` เพื่อเลือกรายงานที่เรา [ดาวน์โหลดรายงาน]({% link _posts/2016-11-20-report_hosxp_pcu.md %}) มาไว้แล้ว 

![import Report](/img/setting/import_report1.png)

> 1. หลังจาก Open แล้วจะปรากฏรายชื่อรายงานที่เราจพนำเข้ามา 
> 2. แล้วให้เราคิอกที่ `Append` เพื่อนำเข้ารายงานเป็นการเสร็จสิ้นแล้ว 

![import Report](/img/setting/import_report2.png)

#### การนำเข้ารายงานทีละรายงาน 
--- 
ในการณีที่เราต้องการนำเข้ารายงานทีละรายงาน หรือ ทีละกลุ่มรายงาน หรือทีละ Module นั่นเองเราสามารถทำได้โดยหลักการเดียวกันกับการนำเข้ารายงานทั้งหมด แต่เราไม่ต้อง
ลบรายงานเดิมออก  สามารถ `Append`เข้าไปได้เลย

> 1. ให้เราเข้าไปที่ [SqlQuery]({% link _posts/2016-11-02-Sql_query_hosxp.md %}) แล้ว พิมพ์ `reporttemplate` แล้วสั่ง `Run` จะได้รายชื่อรายงานที่มีอยู่แล้ว กด `Open` 
> 2.  แล้วให้เลือกที่ `Open` เพื่อเลือกรายงานที่เรา [ดาวน์โหลดรายงาน]({% link _posts/2016-11-20-report_hosxp_pcu.md %}) มาไว้แล้ว 

![import Report](/img/setting/import_report3.png)


> 1. หลังจาก Open แล้วจะปรากฏรายชื่อรายงานที่เราจะนำเข้ามา 
> 2. แล้วให้เราคลิกที่ `Append` เพื่อนำเข้ารายงานเป็นการเสร็จสิ้นแล้ว 

![import Report](/img/setting/import_report2.png)

>หากรายงานที่เรานำเข้ามามีอยู่แล้วในระบบ อาจจะมรีการแจ้งเตือน ซึ่งไม่เป็นไรนะครับ แบบนี้ถือว่าเสร็จสิ้นแล้ว


![import Report](/img/setting/import_report4.png)


